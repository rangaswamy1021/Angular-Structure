<div class="page-title-header">
  <div class="row">
    <div class="col-md-12">
      <ol class="breadcrumb">
        <li>
          <a href="#">TVC</a>
        </li>
        <li class="active">Search Account</li>
      </ol>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="page-header">
        <h1>Search Account</h1>
      </div>
    </div>
  </div>
</div>
<div class="content">
  <app-success-failure-alerts-message [messageFlag]='msgFlag' [msgType]='msgType' [msgTitle]='msgTitle' [msgDesc]='msgDesc'
    (setFlag)="setOutputFlag($event)"></app-success-failure-alerts-message>
  <div class="row">
    <div class="col-md-12 text-right">
      <span class="info-blue"> <img src="assets/images/svg/info-blue.svg" class="icon-svg5" alt=""> </span> <span class="name">Enter input in any  of the fields below.</span>
    </div>
  </div>
  <div class="row">
    <form [formGroup]="violatorSearchForm" name="violatorSearchForm" role="form" (ngSubmit)="onSubmit()" novalidate>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Account No.">Account #</label>
            <input type="text" pattern="[0-9]*" id="AccountNo" name="AccountNo" formControlName="AccountNo" class="form-control" placeholder="Account #">
            <div class="msg" *ngIf="violatorSearchForm.controls['AccountNo'].invalid && (violatorSearchForm.controls['AccountNo'].dirty || violatorSearchForm.controls['AccountNo'].touched)">
              <div *ngIf="violatorSearchForm.controls['AccountNo'].errors.pattern">
                Only numbers allowed.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Invoice No.">Invoice #</label>
            <input type="text" pattern="^[A-Za-z0-9]+$" id="InvoiceNo" name="InvoiceNo" formControlName="InvoiceNo" class="form-control"
              placeholder="Invoice #">
            <div class="msg" *ngIf="violatorSearchForm.controls['InvoiceNo'].invalid && (violatorSearchForm.controls['InvoiceNo'].dirty || violatorSearchForm.controls['InvoiceNo'].touched)">
              <div *ngIf="violatorSearchForm.controls['InvoiceNo'].errors.pattern">
                Only alphanumerics allowed.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Invoice Ref No.">Invoice Ref #</label>
            <input type="text" pattern="^[A-Za-z0-9]+$" id="InvoiceRefNo" name="InvoiceRefNo" formControlName="InvoiceRefNo" class="form-control"
              placeholder="Invoice Ref #">
            <div class="msg" *ngIf="violatorSearchForm.controls['InvoiceRefNo'].invalid && (violatorSearchForm.controls['InvoiceRefNo'].dirty || violatorSearchForm.controls['InvoiceRefNo'].touched)">
              <div *ngIf="violatorSearchForm.controls['InvoiceRefNo'].errors.pattern">
                Only alphanumerics allowed.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Trip No.">Trip #</label>
            <input type="text" pattern="[0-9]*" id="TripNo" name="TripNo" formControlName="TripNo" class="form-control" placeholder="Trip #">
            <div class="msg" *ngIf="violatorSearchForm.controls['TripNo'].invalid && (violatorSearchForm.controls['TripNo'].dirty || violatorSearchForm.controls['TripNo'].touched)">
              <div *ngIf="violatorSearchForm.controls['TripNo'].errors.pattern">
                Only numbers allowed.
              </div>
            </div>
          </div>
        </div>
      </div>



      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="First Name">First Name</label>
            <input type="text" pattern="^[\sa-zA-Z0-9_]+$" id="Fname" name="Fname" formControlName="Fname" class="form-control" placeholder="First Name">
            <div class="msg" *ngIf="violatorSearchForm.controls['Fname'].invalid && (violatorSearchForm.controls['Fname'].dirty || violatorSearchForm.controls['Fname'].touched)">
              <div *ngIf="violatorSearchForm.controls['Fname'].errors.pattern">
                  Only alpha numerics and ( _ ) are allowed
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Last Name">Last Name</label>
            <input type="text" pattern="^[-\sa-zA-Z0-9_]+$" id="Lastname" name="Lastname" formControlName="Lastname" class="form-control"
              placeholder="Last Name">
            <div class="msg" *ngIf="violatorSearchForm.controls['Lastname'].invalid && (violatorSearchForm.controls['Lastname'].dirty || violatorSearchForm.controls['Lastname'].touched)">
              <div *ngIf="violatorSearchForm.controls['Lastname'].errors.pattern">
                  Only alpha numerics and ( _ , - ) are allowed
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">
            <label for="Platno">Plate #</label>
            <input type="text" pattern="^[A-Za-z0-9]+$" id="PlateNo" name="PlateNo" formControlName="PlateNo" class="form-control" placeholder="Plate #">
            <div class="msg" *ngIf="violatorSearchForm.controls['PlateNo'].invalid && (violatorSearchForm.controls['PlateNo'].dirty || violatorSearchForm.controls['PlateNo'].touched)">
              <div *ngIf="violatorSearchForm.controls['PlateNo'].errors.pattern">
                Only alphanumerics allowed.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="row">
          <div class="form-group col-md-12">

            <label for="Address">Address</label>
            <input type="text" id="Address" name="Address" formControlName="Address" class="form-control" placeholder="Address">
          </div>
        </div>
      </div>

      <div class="col-md-12">
        <button type="submit" class="btn btn-primary btn-search" [disabled]="disableButton">Search</button>
        <button type="reset" class="btn btn-default btn-reset" (click)="resetSearch()">Reset</button>
      </div>

    </form>
  </div>

  <div class="panel panel-default m-t-20" *ngIf='violatorSearchResponse && violatorSearchResponse.length'>
    <div class="panel-heading"> Account Search Results </div>
    <div class="panel-body table-bdr">
      <table class="table">
        <thead class="thead-default nowrap">
          <tr>
            <th (click)="sortDirection('CUSTOMERID')" class="sorting-handle"> Account #
              <span *ngIf="gridArrowCUSTOMERID">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <th (click)="sortDirection('VEHICLECSV')" class="sorting-handle"> Plate #
              <span *ngIf="gridArrowVEHICLECSV">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <td>Trip #</td>
            <th (click)="sortDirection('FIRSTNAME')" class="sorting-handle"> First Name
              <span *ngIf="gridArrowFIRSTNAME">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <th (click)="sortDirection('LASTNAME')" class="sorting-handle"> Last Name
              <span *ngIf="gridArrowLASTNAME">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <th (click)="sortDirection('FullAddress')" class="sorting-handle">Address
              <span *ngIf="gridArrowFullAddress">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <th (click)="sortDirection('OUTSTANDINGINVOICECOUNT')" class="sorting-handle">Outstanding Count
              <span *ngIf="gridArrowOUTSTANDINGINVOICECOUNT">
                <i class="fa fa-fw fa-lg" aria-hidden="true" [ngClass]='{"fa-sort-amount-asc":sortingDirection,"fa-sort-amount-desc":!sortingDirection}'></i>
              </span>
            </th>
            <td>Balance Due</td>
            <td>View</td>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of violatorSearchResponse| paginate: { itemsPerPage: pageItemNumber, currentPage: p, totalItems:totalRecordCount };">
            <td> {{res.ViolatorID}} </td>
            <td> {{res.LicensePlate}} </td>
            <td> {{res.TripId}} </td>
            <td> {{res.ViolatorFirstName}} </td>
            <td> {{res.ViolatorSecondName}} </td>
            <td> {{res.FullAddress}} </td>
            <td> {{res.InvoicesCount}} </td>
            <td> {{res.TotalOutstandingAmount | currency:'USD':true:'1.2-2'}} </td>
            <td>
              <a (click)="viewAccount(res)">View</a>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="row page-info" *ngIf="violatorSearchResponse[0].ReCount>10">
        <div class="col-md-6 text-left">
          <p>Display {{startItemNumber}} - {{endItemNumber}} Records of {{totalRecordCount}}</p>
        </div>
        <div class="col-md-6 text-right">
          <pagination-controls (pageChange)="pageChanged($event)"></pagination-controls>
        </div>
      </div>
    </div>
  </div>
  <div class="panel panel-default m-t-20" *ngIf='!(violatorSearchResponse && violatorSearchResponse.length) && afterSearch'>
    <div class="panel-heading"> Account Search Results </div>
    <div class="panel-body bordered">
      <div class="status-content">
        <p>No records to display</p>
      </div>
    </div>
  </div>
</div>
<div class="modal fade bs-example-modal-sm" tabindex="-1" id="pageloader" role="dialog" aria-labelledby="mySmallModalLabel">
  <div class="modal-dialog modal-sm" role="document">
    <div class="text-center">
      <i class="fa fa-spinner fa-pulse fa-3x fa-fw" style="color:#fff;"></i>
      <span class="sr-only">Loading...</span>
    </div>
  </div>
</div>